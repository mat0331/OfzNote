# オフライン対応テキストエディタ PWA 設計書

## 1. プロジェクト概要

### 目的
ブラウザ上で動作し、オフラインでも利用可能なシンプルで使いやすいテキストエディタの開発

### 主要技術
- PWA (Progressive Web App)
- Service Worker
- IndexedDB
- Vanilla JavaScript (またはReact/Vue)

## 2. 機能要件

### 2.1 基本機能

#### 自動保存機能
- 3秒ごとに自動保存
- 保存中インジケーターの表示
- 保存失敗時のリトライ機能

#### メモ管理機能
- 新規メモ作成
- メモの削除（確認ダイアログ付き）
- メモのタイトル編集
- 作成日時・更新日時の記録
- メモの並び替え（更新順/作成順/タイトル順）

#### 検索機能
- タイトル検索
- 本文を含む全文検索
- インクリメンタルサーチ（入力と同時に検索）
- 検索結果のハイライト表示

#### エクスポート/インポート機能
- 単一メモのテキストファイルエクスポート
- 全メモの一括エクスポート（ZIP形式）
- テキストファイルのインポート
- ドラッグ&ドロップ対応

#### カスタマイズ機能
- フォントファミリーの選択（ゴシック/明朝/等幅）
- フォントサイズの調整（12px〜24px）
- 行間の調整
- エディタ幅の調整

### 2.2 UI/UX要件

#### レイアウト
```
+------------------+------------------------+
|                  |                        |
|   サイドバー      |    エディタエリア        |
|   (250px)        |     (残り全幅)          |
|                  |                        |
| [+新規] [検索]    |  タイトル: [        ]   |
|                  |                        |
| メモ一覧          |  本文:                 |
| - メモ1          |  +-----------------+   |
| - メモ2          |  |                 |   |
| - メモ3          |  |                 |   |
|                  |  |                 |   |
+------------------+  +-----------------+   |
                                           |
```

#### レスポンシブデザイン
- モバイル（〜768px）: サイドバーをハンバーガーメニュー化
- タブレット（768px〜）: サイドバー固定表示
- デスクトップ（1024px〜）: フル機能表示

#### ショートカットキー
- `Ctrl/Cmd + S`: 手動保存
- `Ctrl/Cmd + N`: 新規メモ
- `Ctrl/Cmd + F`: 検索
- `Ctrl/Cmd + E`: エクスポート
- `Ctrl/Cmd + ,`: 設定画面

#### テーマカスタマイズ
- プリセットテーマ（ライト/ダーク/セピア）
- カスタムテーマ作成機能
  - 背景色
  - テキスト色
  - アクセント色
  - サイドバー背景色
- テーマのエクスポート/インポート

## 3. 技術仕様

### 3.1 ファイル構成
```
/
├── index.html
├── manifest.json
├── service-worker.js
├── css/
│   ├── style.css
│   └── themes/
│       ├── light.css
│       ├── dark.css
│       └── sepia.css
├── js/
│   ├── app.js
│   ├── db.js        # IndexedDB操作
│   ├── editor.js    # エディタ機能
│   ├── storage.js   # ストレージ管理
│   └── ui.js        # UI制御
└── icons/
    └── icon-*.png   # PWAアイコン
```

### 3.2 データ構造

#### IndexedDB スキーマ
```javascript
// データベース名: 'TextEditorDB'
// バージョン: 1

// notes ストア
{
  id: 'uuid',           // 主キー
  title: 'string',      // メモタイトル
  content: 'string',    // メモ本文
  createdAt: 'date',    // 作成日時
  updatedAt: 'date',    // 更新日時
  tags: ['array'],      // タグ（将来拡張用）
}

// settings ストア
{
  key: 'string',        // 設定キー
  value: 'any',         // 設定値
}
```

### 3.3 Service Worker 戦略

#### キャッシュ対象
- HTML/CSS/JSファイル
- フォントファイル
- アイコン画像

#### キャッシュ戦略
```javascript
// Cache First戦略
const CACHE_NAME = 'text-editor-v1';
const urlsToCache = [
  '/',
  '/css/style.css',
  '/js/app.js',
  // ... 他の静的ファイル
];
```

### 3.4 セキュリティ考慮事項
- XSS対策: textContentを使用、innerHTMLは避ける
- CSP (Content Security Policy) の設定
- HTTPS必須（PWA要件）

## 4. 開発フェーズ

### Phase 1: MVP (1週間)
- [ ] 基本的なエディタ機能
- [ ] 単一メモの保存/読み込み
- [ ] Service Worker実装
- [ ] オフライン対応

### Phase 2: 機能拡張 (1週間)
- [ ] 複数メモ管理
- [ ] 検索機能
- [ ] エクスポート/インポート
- [ ] レスポンシブ対応

### Phase 3: UI改善 (1週間)
- [ ] テーマ機能
- [ ] フォントカスタマイズ
- [ ] ショートカットキー
- [ ] アニメーション追加

### Phase 4: 最適化 (3日)
- [ ] パフォーマンス最適化
- [ ] エラーハンドリング強化
- [ ] ユーザーテスト
- [ ] ドキュメント作成

## 5. 今後の拡張案
- マークダウン対応
- 同期機能（オプション）
- 画像貼り付け対応
- メモのフォルダ分け
- タグ機能の実装
- 印刷対応
- 音声入力

## 6. 必要なリソース
- GitHub Pages (ホスティング)
- アイコンデザイン
- テストユーザー（3-5名）